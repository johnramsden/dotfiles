---
# Canonical (Ubuntu) specific tasks

- name: Install base packages (Ubuntu/Debian)
  become: true
  apt:
    name:
      - git
      - zsh
      - openssh-client
      - curl
      - wget
      - nano
      - build-essential
      - flatpak
      - man-db
      - manpages
      - rsync
      - htop
      - neofetch
      - gnupg
      - ca-certificates
    state: present
    update_cache: true

- name: Create Canonical workspace directory
  file:
    path: "{{ ansible_env.HOME }}/Canonical"
    state: directory
    mode: '0755'

# ==================== EXTERNAL REPOSITORIES ====================
- name: Load external repository definitions
  include_vars:
    file: "{{ playbook_dir }}/vars/external_repos.yml"

- name: Setup external APT repositories
  include_tasks: "{{ playbook_dir }}/tasks/external_repos.yml"

# ==================== SNAP PACKAGES ====================
- name: Install snap packages
  include_tasks: "{{ playbook_dir }}/tasks/snap_packages.yml"

# ==================== SYSTEMD USER SERVICES ====================
- name: Enable and start ssh-agent service
  systemd:
    name: ssh-agent.service
    enabled: true
    state: started
    scope: user
